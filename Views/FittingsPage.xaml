<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:MechTools.ViewModels"
             xmlns:models="clr-namespace:MechTools.Models"
             x:Class="MechTools.Views.FittingsPage"
             Title="Raccordi Idraulici ðŸ’§"
             BackgroundColor="#121212">

    <CollectionView ItemsSource="{Binding FittingsList}"
                    SelectionMode="None">

        <CollectionView.Header>
            <VerticalStackLayout Spacing="15" Padding="15">

                <Border Stroke="#333333" StrokeThickness="1" BackgroundColor="#1E1E1E" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10"/>
                    </Border.StrokeShape>
                    <VerticalStackLayout Spacing="10">
                        <Label Text="IDENTIFICA DA DIAMETRO ðŸ“" TextColor="#FF9900" FontAttributes="Bold" FontSize="12"/>
                        <Grid ColumnDefinitions="*,*,Auto" ColumnSpacing="10">
                            <Entry Grid.Column="0" Placeholder="Punta" Text="{Binding DiameterTip}" Keyboard="Numeric" TextColor="White" PlaceholderColor="#666" BackgroundColor="#2D2D2D"/>
                            <Entry Grid.Column="1" Placeholder="Fondo" Text="{Binding DiameterBottom}" Keyboard="Numeric" TextColor="White" PlaceholderColor="#666" BackgroundColor="#2D2D2D"/>
                            <Button Grid.Column="2" Text="ðŸ”" Command="{Binding AnalyzeCommand}" BackgroundColor="#FF9900" TextColor="Black" FontAttributes="Bold"/>
                        </Grid>
                        <Label Text="{Binding DetectorResult}" TextColor="White" FontAttributes="Bold" HorizontalTextAlignment="Center" FontSize="16"/>
                    </VerticalStackLayout>
                </Border>

                <Border Stroke="#FF9900" StrokeThickness="1" BackgroundColor="#1E1E1E" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10"/>
                    </Border.StrokeShape>
                    <VerticalStackLayout Spacing="10">
                        <Label Text="TROVA ADATTATORE ðŸ”—" TextColor="#FF9900" FontAttributes="Bold" FontSize="12"/>
                        <Label Text="Seleziona cosa hai (A) e dove devi andare (B):" TextColor="Gray" FontSize="11"/>

                        <Grid ColumnDefinitions="*, *" ColumnSpacing="10">
                            <VerticalStackLayout Grid.Column="0" Spacing="5">
                                <Label Text="PARTENZA (A)" TextColor="White" HorizontalOptions="Center" FontAttributes="Bold" FontSize="12"/>
                                <Picker x:Name="PkGenderA" Title="M/F" TextColor="White" TitleColor="Gray" BackgroundColor="#2D2D2D" SelectedIndex="0">
                                    <Picker.ItemsSource>
                                        <x:Array Type="{x:Type x:String}">
                                            <x:String>Maschio</x:String>
                                            <x:String>Femmina</x:String>
                                        </x:Array>
                                    </Picker.ItemsSource>
                                </Picker>
                                <Picker x:Name="PkSizeA" Title="Misura" TextColor="White" TitleColor="Gray" BackgroundColor="#2D2D2D" SelectedIndex="1">
                                    <Picker.ItemsSource>
                                        <x:Array Type="{x:Type x:String}">
                                            <x:String>1/8"</x:String>
                                            <x:String>1/4"</x:String>
                                            <x:String>3/8"</x:String>
                                            <x:String>1/2"</x:String>
                                            <x:String>3/4"</x:String>
                                            <x:String>1"</x:String>
                                        </x:Array>
                                    </Picker.ItemsSource>
                                </Picker>
                                <Picker x:Name="PkTypeA" Title="Tipo" TextColor="White" TitleColor="Gray" BackgroundColor="#2D2D2D" SelectedIndex="0">
                                    <Picker.ItemsSource>
                                        <x:Array Type="{x:Type x:String}">
                                            <x:String>GAS</x:String>
                                            <x:String>NPT</x:String>
                                            <x:String>Metrico</x:String>
                                        </x:Array>
                                    </Picker.ItemsSource>
                                </Picker>
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                <Label Text="ARRIVO (B)" TextColor="White" HorizontalOptions="Center" FontAttributes="Bold" FontSize="12"/>
                                <Picker x:Name="PkGenderB" Title="M/F" TextColor="White" TitleColor="Gray" BackgroundColor="#2D2D2D" SelectedIndex="1">
                                    <Picker.ItemsSource>
                                        <x:Array Type="{x:Type x:String}">
                                            <x:String>Maschio</x:String>
                                            <x:String>Femmina</x:String>
                                        </x:Array>
                                    </Picker.ItemsSource>
                                </Picker>
                                <Picker x:Name="PkSizeB" Title="Misura" TextColor="White" TitleColor="Gray" BackgroundColor="#2D2D2D" SelectedIndex="1">
                                    <Picker.ItemsSource>
                                        <x:Array Type="{x:Type x:String}">
                                            <x:String>1/8"</x:String>
                                            <x:String>1/4"</x:String>
                                            <x:String>3/8"</x:String>
                                            <x:String>1/2"</x:String>
                                            <x:String>3/4"</x:String>
                                            <x:String>1"</x:String>
                                        </x:Array>
                                    </Picker.ItemsSource>
                                </Picker>
                                <Picker x:Name="PkTypeB" Title="Tipo" TextColor="White" TitleColor="Gray" BackgroundColor="#2D2D2D" SelectedIndex="0">
                                    <Picker.ItemsSource>
                                        <x:Array Type="{x:Type x:String}">
                                            <x:String>GAS</x:String>
                                            <x:String>NPT</x:String>
                                            <x:String>Metrico</x:String>
                                        </x:Array>
                                    </Picker.ItemsSource>
                                </Picker>
                            </VerticalStackLayout>
                        </Grid>

                        <Button Text="CALCOLA RACCORDO" Clicked="BtnCalcolaRaccordo_Clicked" BackgroundColor="#FF9900" TextColor="Black" FontAttributes="Bold"/>
                        <Label x:Name="LblRisultatoRaccordo" Text="" TextColor="#FF9900" FontSize="14" HorizontalTextAlignment="Center" FontAttributes="Bold"/>
                    </VerticalStackLayout>
                </Border>

                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Button Grid.Column="0" Text="GAS (BSP)" Command="{Binding LoadGasCommand}" BackgroundColor="#007ACC" TextColor="White" HeightRequest="40"/>
                    <Button Grid.Column="1" Text="NPT (USA)" Command="{Binding LoadNptCommand}" BackgroundColor="#D32F2F" TextColor="White" HeightRequest="40"/>
                </Grid>

                <Label Text="{Binding CurrentStandardName}" TextColor="Gray" FontSize="12" HorizontalOptions="Center" Margin="0,5,0,0"/>

            </VerticalStackLayout>
        </CollectionView.Header>

        <CollectionView.ItemTemplate>
            <DataTemplate x:DataType="models:Fitting">
                <Border StrokeThickness="0" BackgroundColor="#1E1E1E" Margin="15,5" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <Grid ColumnDefinitions="Auto, *" RowDefinitions="Auto, Auto">
                        <Label Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Text="{Binding Name}" FontSize="24" FontAttributes="Bold" TextColor="#FF9900" VerticalOptions="Center" Margin="0,0,15,0"/>
                        <Label Grid.Row="0" Grid.Column="1" Text="{Binding Type}" FontSize="12" TextColor="Gray" HorizontalOptions="End"/>
                        <HorizontalStackLayout Grid.Row="1" Grid.Column="1" Spacing="10" HorizontalOptions="End">
                            <Label Text="{Binding OuterDiameterMm, StringFormat='Ã˜ {0} mm'}" TextColor="White" FontAttributes="Bold"/>
                            <Label Text="|" TextColor="Gray"/>
                            <Label Text="{Binding TPI, StringFormat='{0} TPI'}" TextColor="#AAAAAA"/>
                        </HorizontalStackLayout>
                    </Grid>
                </Border>
            </DataTemplate>
        </CollectionView.ItemTemplate>

        

    </CollectionView>
</ContentPage>